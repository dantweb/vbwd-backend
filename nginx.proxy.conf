# ── VBWD Proxy ────────────────────────────────────────────────────────────────
# Place at ~/web_server/vbwd_app/nginx.proxy.conf on the server
#
# Set your domains in /etc/hosts or DNS:
#   vbwd.yourdomain.com       → user app
#   admin.vbwd.yourdomain.com → admin app
#
# For SSL: uncomment the HTTPS blocks and mount certs into ./ssl/

# ── User App ──────────────────────────────────────────────────────────────────
server {
    listen 80;
    server_name vbwd.yourdomain.com;

    location / {
        proxy_pass         http://vbwd_fe_user:80;
        proxy_set_header   Host              $host;
        proxy_set_header   X-Real-IP         $remote_addr;
        proxy_set_header   X-Forwarded-For   $proxy_add_x_forwarded_for;
        proxy_set_header   X-Forwarded-Proto $scheme;
        proxy_read_timeout 60s;
    }
}

# ── Admin App ─────────────────────────────────────────────────────────────────
server {
    listen 80;
    server_name admin.vbwd.yourdomain.com;

    location / {
        proxy_pass         http://vbwd_fe_admin:80;
        proxy_set_header   Host              $host;
        proxy_set_header   X-Real-IP         $remote_addr;
        proxy_set_header   X-Forwarded-For   $proxy_add_x_forwarded_for;
        proxy_set_header   X-Forwarded-Proto $scheme;
        proxy_read_timeout 60s;
    }
}

# ── HTTPS (uncomment after getting SSL certs) ─────────────────────────────────
# server {
#     listen 443 ssl;
#     server_name vbwd.yourdomain.com;
#     ssl_certificate     /etc/nginx/ssl/vbwd.crt;
#     ssl_certificate_key /etc/nginx/ssl/vbwd.key;
#     location / {
#         proxy_pass http://vbwd_fe_user:80;
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#         proxy_set_header X-Forwarded-Proto https;
#     }
# }
#
# server {
#     listen 443 ssl;
#     server_name admin.vbwd.yourdomain.com;
#     ssl_certificate     /etc/nginx/ssl/admin.vbwd.crt;
#     ssl_certificate_key /etc/nginx/ssl/admin.vbwd.key;
#     location / {
#         proxy_pass http://vbwd_fe_admin:80;
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#         proxy_set_header X-Forwarded-Proto https;
#     }
# }
